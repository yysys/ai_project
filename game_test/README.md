# Game Test Suite

## 概述

这是 `game` 开发代码的测试套件，包含全面的自动化测试以确保游戏运行符合用户预期。

## 测试覆盖范围

### 核心游戏机制测试 (comprehensive.test.js)
完整的游戏机制测试，包括：

1. **格子移动机制**
   - 四个方向的移动测试
   - 多步移动测试
   - 无阻挡情况下的自由移动

2. **阻挡检测**
   - 碰到其他格子时停止
   - 多尺寸格子的碰撞检测
   - 忽略已消失格子的碰撞

3. **屏幕边缘消失机制**
   - 菱形区域外消失
   - 网格边界外消失
   - 多尺寸格子的消失判断

4. **胜利条件**
   - 狗格子消失触发胜利
   - 狼格子消失不触发胜利

5. **点击检测**
   - 旋转网格上的点击识别
   - 空白区域点击处理

6. **集成测试**
   - 完整的点击到移动流程

### 单元测试文件
- `constants.test.js` - 常量定义测试
- `puzzleManager.test.js` - 谜题管理器测试
- `gameStateManager.test.js` - 游戏状态管理器测试
- `levelManager.test.js` - 关卡管理器测试
- `unit.test.js` - 游戏单元测试
- `unitManager.test.js` - 单元管理器测试
- `gridClickMovement.test.js` - 网格点击移动测试

## 运行测试

### 安装依赖
```bash
cd game_test
npm install
```

### 运行所有测试
```bash
npm test
```

### 监听模式运行测试
```bash
npm run test:watch
```

### 生成测试覆盖率报告
```bash
npm run test:coverage
```

## 测试环境配置

- Jest 测试框架
- Node.js 测试环境
- Mock Canvas 用于渲染测试

## 移动屏幕尺寸

测试使用标准移动设备屏幕尺寸：
- 宽度: 375px
- 高度: 667px

## 游戏核心规则

1. **点击格子**: 点击游戏中的格子后，格子会沿着自己设定的方向移动
2. **阻挡停止**: 如果碰到其他格子的阻挡，格子会停下
3. **边缘消失**: 如果没有阻挡，格子会移动到手机屏幕边缘（菱形区域或网格边界），然后消失
4. **胜利条件**: 当狗格子消失时，游戏胜利
