# 测试运行指南 - 拯救菜狗

## 单元测试结果

✅ **测试状态**: 全部通过
- **总测试数**: 96
- **通过数**: 96
- **失败数**: 0
- **通过率**: 100%
- **执行时间**: 2.365秒

### 测试覆盖

1. **常量测试** (11个) ✅
   - 方向常量
   - 方向向量
   - 方向角度
   - 工具函数

2. **单位测试** (17个) ✅
   - Unit类构造和方法
   - VegetableDog类
   - Wolf类

3. **单位管理器测试** (23个) ✅
   - 单位创建
   - 点击处理
   - 更新和边界检测
   - 状态查询

4. **关卡管理器测试** (20个) ✅
   - 关卡初始化
   - 关卡解锁
   - 星级和分数计算
   - 进度管理

5. **游戏状态管理器测试** (25个) ✅
   - 状态管理
   - 暂停/继续
   - 计时器
   - 事件监听

## 在开发者工具中运行

### 方法一：微信开发者工具

1. **下载微信开发者工具**
   - 访问：https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html
   - 下载对应平台的版本

2. **打开项目**
   - 启动微信开发者工具
   - 点击"导入项目"
   - 选择项目目录：`/Users/qinkuang.chen/traeProject/ai_project/game`
   - 填写 AppID（可以使用测试号）
   - 项目名称：拯救菜狗
   - 点击"导入"

3. **运行项目**
   - 项目导入后会自动编译
   - 在模拟器中可以看到游戏界面
   - 点击"开始游戏"按钮开始

4. **测试功能**
   - ✅ 主页：查看菜狗吉祥物和开始按钮
   - ✅ 关卡选择：查看10个关卡
   - ✅ 游戏：点击菜狗或狼，观察跑动效果
   - ✅ 结果：完成关卡后查看星级和分数

### 方法二：抖音开发者工具

1. **下载抖音开发者工具**
   - 访问：https://developer.open-douyin.com/docs/resource/developer-docs/development-tool/mini-app/development-tool/update-and-download
   - 下载对应平台的版本

2. **打开项目**
   - 启动抖音开发者工具
   - 点击"导入项目"
   - 选择项目目录：`/Users/qinkuang.chen/traeProject/ai_project/game`
   - 填写 AppID
   - 项目名称：拯救菜狗
   - 点击"导入"

3. **运行项目**
   - 项目导入后会自动编译
   - 在模拟器中可以看到游戏界面
   - 点击"开始游戏"按钮开始

## 功能测试清单

### 主页测试

- [ ] 显示游戏标题"拯救菜狗"
- [ ] 显示菜狗吉祥物（浮动动画）
- [ ] 显示"开始游戏"按钮
- [ ] 点击"开始游戏"跳转到关卡页
- [ ] 背景渐变效果正常

### 关卡页测试

- [ ] 显示10个关卡
- [ ] 第1关已解锁，其他关卡锁定
- [ ] 点击已解锁关卡进入游戏
- [ ] 点击锁定关卡显示提示
- [ ] 显示总星级统计
- [ ] 星级显示正确

### 游戏页测试

- [ ] 显示当前关卡标题
- [ ] 显示菜狗（屏幕中心，金色边框）
- [ ] 显示狼群（随机分布）
- [ ] 点击单位后开始跑动
- [ ] 单位沿对角线方向跑动
- [ ] 菜狗跑出屏幕后显示胜利
- [ ] 限时关卡显示倒计时
- [ ] 超时后显示失败
- [ ] 暂停功能正常
- [ ] 重置功能正常
- [ ] 返回功能正常

### 结果页测试

- [ ] 胜利时显示"过关成功"
- [ ] 失败时显示"游戏失败"
- [ ] 显示星级评定（1-3星）
- [ ] 显示分数
- [ ] 显示奖励
- [ ] "返回首页"按钮正常
- [ ] "下一关"按钮正常（胜利时）
- [ ] "重试"按钮正常（失败时）

### 游戏机制测试

- [ ] 菜狗位于屏幕中心
- [ ] 狼群不靠近中心
- [ ] 单位有预设的四个方向之一
- [ ] 点击后单位沿预设方向跑动
- [ ] 单位跑出屏幕边界后消失
- [ ] 菜狗跑出屏幕即获胜
- [ ] 限时关卡超时即失败
- [ ] 星级计算正确
- [ ] 分数计算正确
- [ ] 关卡解锁机制正常

### 数据持久化测试

- [ ] 游戏进度自动保存
- [ ] 关卡解锁状态保存
- [ ] 最高分记录保存
- [ ] 总分数保存
- [ ] 金币数量保存
- [ ] 重新打开后数据恢复

## 性能测试

### 帧率测试

- [ ] 游戏运行流畅，无明显卡顿
- [ ] 目标帧率：60 FPS
- [ ] 动画效果平滑

### 内存测试

- [ ] 内存占用合理
- [ ] 无明显内存泄漏
- [ ] 长时间运行稳定

## 常见问题排查

### 问题1：项目无法导入

**解决方案**：
- 确保选择了正确的项目目录
- 检查 app.json 文件是否存在
- 检查 AppID 是否正确

### 问题2：页面空白

**解决方案**：
- 检查控制台是否有错误
- 确认所有依赖已安装（npm install）
- 清除缓存重新编译

### 问题3：游戏无法点击

**解决方案**：
- 检查 Canvas 是否正确初始化
- 检查触摸事件是否正确绑定
- 查看控制台错误信息

### 问题4：测试失败

**解决方案**：
- 运行 `npm install` 重新安装依赖
- 运行 `npm test` 查看具体错误
- 检查 Node.js 版本（建议 >= 14.0.0）

## 调试技巧

### 使用开发者工具调试

1. **打开调试器**
   - 微信开发者工具：点击"调试器"按钮
   - 抖音开发者工具：点击"调试"按钮

2. **查看控制台**
   - 查看 Console 输出
   - 查看 Network 请求
   - 查看 Storage 数据

3. **断点调试**
   - 在代码中设置断点
   - 单步执行
   - 查看变量值

### 查看日志

游戏代码中已添加 console.log，可以在控制台查看：
- 游戏启动日志
- 关卡加载日志
- 点击事件日志
- 游戏状态变化日志

## 测试报告模板

### 测试环境
- **测试平台**: 微信小程序 / 抖音小游戏
- **测试设备**: 模拟器 / 真机
- **测试时间**: YYYY-MM-DD HH:mm:ss
- **测试人员**: [姓名]

### 测试结果
| 测试项 | 预期结果 | 实际结果 | 状态 | 备注 |
|--------|----------|----------|------|------|
| 主页显示 | 正常 | [ ] | [ ] | |
| 关卡选择 | 正常 | [ ] | [ ] | |
| 游戏运行 | 正常 | [ ] | [ ] | |
| 点击交互 | 正常 | [ ] | [ ] | |
| 胜利判定 | 正常 | [ ] | [ ] | |
| 失败判定 | 正常 | [ ] | [ ] | |
| 数据保存 | 正常 | [ ] | [ ] | |

### 问题记录
| 序号 | 问题描述 | 严重程度 | 处理状态 | 备注 |
|------|----------|----------|----------|------|
| 1 | | | | |
| 2 | | | | |

## 下一步

测试完成后，可以进行以下操作：

1. **发布到生产环境**
   - 微信小程序：提交审核
   - 抖音小游戏：提交审核

2. **优化和改进**
   - 根据测试反馈优化性能
   - 修复发现的问题
   - 添加新功能

3. **用户测试**
   - 邀请用户进行测试
   - 收集用户反馈
   - 持续改进

---

**文档版本**: v1.0
**最后更新**: 2026-02-09
**测试状态**: 单元测试全部通过 ✅
